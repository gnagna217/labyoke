extends layout

block content
	div(class="container login2 marginbottom margintop")
		//img(src="/images/pile.png" class="accountlogo desktabonly" style="z-index: -1;")
		h1= i18n.__("reports.title")
		p!= i18n.__("reports.subtitle")

			- var now = (new Date())
			- now = (now.getMonth() + 1) + "/" + now.getDate() + "/" + now.getFullYear()
		- var selResultsMoney = resultsMoney
		- var checkedstrMoney = false;
		- if(section !=null && section.length>0 && section == "money")
			- checkedstrMoney = true
		- var selResultsOrders = resultsOrders
		- var checkedstrOrders = false;
		- if(section !=null && section.length>0 && section == "orders")
			- checkedstrOrders = true
		- var selResultsShares = resultsShares
		- var checkedstrShares = false;
		- if(section !=null && section.length>0 && section == "shares")
			- checkedstrShares = true
		- var selResultsInsuff = resultsInsuff
		- var checkedstrInsuff = false;
		- if(section !=null && section.length>0 && section == "insuff")
			- checkedstrInsuff = true
		form(action="reportSelect", method="post", class="adjustwidthreports")
			div(class="buttonss")
				select(name="reportSelect" type="text" id="reportSelect" class="form-control" style="border-color:#3d9dcb;margin-bottom:10px" placeholder=i18n.__("reports.form.select"))
					option(value="reportNone",style="font-weight:bold")=i18n.__("reports.form.option1")
					option(value="reportMoney" selected=(checkedstrMoney===true ? "selected" : undefined))=i18n.__("reports.form.option2")
					option(value="reportOrders" selected=(checkedstrOrders===true ? "selected" : undefined))=i18n.__("reports.form.option3")
					option(value="reportShares" selected=(checkedstrShares===true ? "selected" : undefined))=i18n.__("reports.form.option4")
					option(value="reportInsuff" selected=(checkedstrInsuff===true ? "selected" : undefined))=i18n.__("reports.form.option5")
				div(style="top: -35px; position: relative; float: right; margin-right: 10px;")
					div(class="arrow-up")
					div(class="arrow-down")
		script.
			window.onload = function() {
			$('#reportMoney').hide();
			$('#reportShares').hide();
			$('#reportOrders').hide();
			$('#reportInsuff').hide();

			/*var resultsMoney = "#{resultsMoney}";
			var resultsOrders = "#{resultsOrders}";
			var resultsShares = "#{resultsShares}";
			var resultsInsuff = "#{resultsInsuff}";
			console.log("resultsOrders: " + resultsOrders.length);
			console.log("resultsShares: " + resultsShares.length);
			console.log("resultsMoney: " + resultsMoney.length);
			console.log("resultsInsuff: " + resultsInsuff.length);*/

			var eSelect = document.getElementById('reportSelect');
			console.debug("selected: " + $('#reportSelect').val());

			if(eSelect.selectedIndex === 1 || $('#reportSelect').val() == 'reportMoney') {
				console.log("resultsMoney inside");
				$('.containerreport').hide();
				$('#reportMoney').show();
				$('#reportShares').hide();
				$('#reportOrders').hide();
				$('#reportInsuff').hide();
			} else if(eSelect.selectedIndex === 2 || $('#reportSelect').val() == 'reportOrders') {
				console.log("resultsOrders inside");
				$('.containerreport').hide();
				$('#reportOrders').show();
				$('#reportShares').hide();
				$('#reportMoney').hide();
				$('#reportInsuff').hide();
			} else if(eSelect.selectedIndex === 3 || $('#reportSelect').val() == 'reportShares') {
				console.log("resultsShares inside");
				$('.containerreport').hide();
				$('#reportShares').show();
				$('#reportMoney').hide();
				$('#reportOrders').hide();
				$('#reportInsuff').hide();
			} else if(eSelect.selectedIndex === 4 || $('#reportSelect').val() == 'reportInsuff') {
				console.log("resultsInsuff inside");
				$('.containerreport').hide();
				$('#reportInsuff').show();
				$('#reportShares').hide();
				$('#reportOrders').hide();
				$('#reportMoney').hide();
			} else if(eSelect.selectedIndex === 0 || $('#reportSelect').val() == 'reportNone') {
				console.log("result None inside");
				$('.containerreport').show();
				$('#reportInsuff').hide();
				$('#reportShares').hide();
				$('#reportOrders').hide();
				$('#reportMoney').hide();
			}

				eSelect.onchange = function() {
					if(eSelect.selectedIndex === 1 || $('#reportSelect').val() == 'reportMoney') {
						console.log("resultsMoney inside");
						$('.containerreport').hide();
						$('#reportMoney').show();
						$('#reportShares').hide();
						$('#reportOrders').hide();
						$('#reportInsuff').hide();
					} else if(eSelect.selectedIndex === 2 || $('#reportSelect').val() == 'reportOrders') {
						console.log("resultsOrders inside");
						$('.containerreport').hide();
						$('#reportOrders').show();
						$('#reportShares').hide();
						$('#reportMoney').hide();
						$('#reportInsuff').hide();
					} else if(eSelect.selectedIndex === 3 || $('#reportSelect').val() == 'reportShares') {
						console.log("resultsShares inside");
						$('.containerreport').hide();
						$('#reportShares').show();
						$('#reportMoney').hide();
						$('#reportOrders').hide();
						$('#reportInsuff').hide();
					}else if(eSelect.selectedIndex === 4 || $('#reportSelect').val() == 'reportInsuff') {
						console.log("resultsInsuff inside");
						$('.containerreport').hide();
						$('#reportInsuff').show();
						$('#reportShares').hide();
						$('#reportOrders').hide();
						$('#reportMoney').hide();
					} else if(eSelect.selectedIndex === 0 || $('#reportSelect').val() == 'reportNone') {
						console.log("result None inside");
						$('.containerreport').show();
						$('#reportInsuff').hide();
						$('#reportShares').hide();
						$('#reportOrders').hide();
						$('#reportMoney').hide();
					}
				}
			}
		div(class="reportSlot") &nbsp;
		div
			div(class="reportMoney results", id="reportMoney")
				div
				h4= i18n.__("reports.money.title")
				p= i18n.__("reports.money.subtitle")
				- var datefrom_money = datefromMoney
				- var dateto_money = datetoMoney
				- var file_money = i18n.__("reports.money.file") + datefrom_money + i18n.__("reports.file.to") + dateto_money + ".pdf"
				- var message_fail_share = i18n.__("reports.money.message.fail")
				- var message_success_money = i18n.__("reports.money.message.success1") + datefrom_money + i18n.__("reports.money.message.success2") + dateto_money + i18n.__("reports.money.message.success3")
				- if(datefromMoney == null || datefromMoney == undefined || datefromMoney == "")
					- datefrom_money = i18n.__("reports.money.message.datefrommoney")
					- dateto_money = ""
					- message_success_money = i18n.__("reports.money.message.successmoney")
					- file_money = i18n.__("reports.money.file_all") + ".pdf" 
				if (addMessageMoney == 'failure')
					div(class="alert alert-danger")!= message_fail_share
				if (addMessageMoney == 'success')
					div(class="alert alert-success fade in alert-dismissable")!= message_success_money
				div
					form(action="reportMoney", method="post", id="formreportMoney")
						div(class="buttonss")
							label(style="top: 23px; position: relative;font-weight: bold;")= i18n.__("reports.money.datefrom")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateFromMoney" style="margin-left: 40px;margin-top: -13px;margin-bottom:10px;margin-top: -13px;" type="text" id="reportDateFromMoney" class="form-control")
							
							label(style="top: 23px; position: relative;font-weight: bold;")= i18n.__("reports.money.dateto")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateToMoney" style="margin-left: 40px;margin-top: -13px;margin-bottom:10px;margin-top: -13px;" type="text" id="reportDateToMoney" class="form-control")

							label(style="width: 100%;font-weight: bold;margin-top:10px;")!= i18n.__("reports.money.lab.label") + dept + "</span>"
							select(name="reportLabMoney" type="text" id="reportLabMoney" class="form-control" style="border-color:#3d9dcb;margin-bottom:10px" placeholder=i18n.__("reports.money.labselect"))
								option(value="all")=i18n.__("reports.money.lab.option")
								if(categories != undefined)
									- var ob = categories
									- for(var prop in ob)
										- var lab = ob[prop].labname
										option(value=lab) #{lab}
							div(style="top: -35px; position: relative; float: right; margin-right: 10px;")
								div(class="arrow-up")
								div(class="arrow-down")
							label(style="width: 100px;font-weight: bold;margin-top:10px;")=i18n.__("reports.money.show")
							br
							label(style="width: 65px;font-weight: bold;")=i18n.__("reports.money.reagent")
							input(type="checkbox" name="reportAgentMoney" id="reportAgentMoney" value="reagent" style="margin-top: -13px;")
							label(style="width: 60px; margin-left: 20px;font-weight: bold;")=i18n.__("reports.money.vendor")
							input(type="checkbox" name="reportVendorMoney" id="reportVendorMoney" value="vendor" style="margin-top: -13px;")
							label(style="width: 75px; margin-left: 20px;font-weight: bold;")=i18n.__("reports.money.catalog")
							input(type="checkbox" name="reportCatalogMoney" id="reportCatalogMoney" value="catalogNumber" style="margin-top: -13px;")
							div(style="max-width:100%; margin-top: 20px;")
								button.btn.btn-success.btn-lg.btn-block(type="submit",value="Report",name="submit", style="max-width: 85%;width: 85%;")= i18n.__("reports.money.button")
								img(src="images/logo_one_bottle_L.png", alt="The Lab", title="Lab", class="reportbutton")
						if(resultsMoney != null && resultsMoney !="")
							script(type="text/javascript" src="/javascripts/jspdf.js")
							script(type="text/javascript" src="/javascripts/FileSaver.js")
							script.
								var ob = "#{resultsMoney}"
								ob = ob.replace(/&lt;/g,"<");
								ob = ob.replace(/&gt;/g,">");
								var pdf = new jsPDF('l', 'pt', 'ledger');
								var pdf2 = new jsPDF('l', 'pt', 'ledger');
								source = ob;
								specialElementHandlers = {
									'#bypassme': function(element, renderer) {
									return true;
								}
								};
								margins = {
									top: 30,
									bottom: 30,
									left: 40,
									right: 40,
									width: 622
								};
								pdf.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf.output('dataurlnewwindow');
								}

								}
								, margins);	
								pdf2.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf2.save("#{file_money}");
								}
								}
								, margins);
							- resultsMoney = ""
					script.
						$(window).scrollTop($('.reportMoney').offset().top).scrollLeft($('.reportMoney').offset().left);
			div(class="reportOrders results", id="reportOrders")
				div(style="/*background-color: #3d9dcb; height: 2px; margin-bottom: 30px; margin-top: 30px;*/")
				h4= i18n.__("reports.orders.title")
				p= i18n.__("reports.orders.subtitle")
				- var datefrom_orders = datefromOrders
				- var dateto_orders = datetoOrders
				- var file_orders = i18n.__("reports.orders.file") + datefrom_orders + i18n.__("reports.file.to") + dateto_orders + ".pdf"
				- var message_fail_order = i18n.__("reports.orders.message.fail")
				- var message_success_order = i18n.__("reports.orders.message.success1") + datefrom_orders + i18n.__("reports.orders.message.success2") + dateto_orders + i18n.__("reports.orders.message.success3")
				- if(datefromOrders == null || datefromOrders == undefined || datefromOrders == "")
					- datefrom_orders = i18n.__("reports.orders.lab.option")
					- dateto_orders = ""
					- message_success_order = i18n.__("reports.orders.message.successorders")
					- file_orders = i18n.__("reports.orders.file_all") + ".pdf" 
				if (addMessageOrders == 'failure')
					div(class="alert alert-danger")!= message_fail_order
				if (addMessageOrders == 'success')
					div(class="alert alert-success fade in alert-dismissable")!= message_success_order
				div
					form(action="reportOrders", method="post")
						div(class="buttonss")
							label(style="top: 23px; position: relative;font-weight: bold;")=i18n.__("reports.orders.datefrom")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateFromOrders" style="margin-left: 40px;;margin-bottom:10px;margin-top: -13px;" type="text" id="reportDateFromOrders" class="form-control")
							
							label(style="top: 23px; position: relative;font-weight: bold;")=i18n.__("reports.orders.dateto")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateToOrders" style="margin-left: 40px;margin-bottom:10px; margin-top: -13px;" type="text" id="reportDateToOrders" class="form-control")
							
							label(style="width: 100%;font-weight: bold;margin-top:10px;")!= i18n.__("reports.orders.lab.label") + dept + "</span>"
							select(name="reportLabOrders" type="text" id="reportLabOrders" class="form-control" style="border-color:#3d9dcb;margin-bottom:10px" placeholder=i18n.__("reports.orders.labselect"))
								option(value="all")= i18n.__("reports.orders.lab.option")
								if(categories != undefined)
									- var ob = categories
									- for(var prop in ob)
										- var lab = ob[prop].labname
										option(value=lab) #{lab}
							div(style="top: -35px; position: relative; float: right; margin-right: 10px;")
								div(class="arrow-up")
								div(class="arrow-down")
							div(style="max-width:100%; margin-top: 20px;")
								button.btn.btn-success.btn-lg.btn-block(type="submit",value="Report",name="submit", style="max-width: 85%;width: 85%;")= i18n.__("reports.orders.button")
								img(src="images/logo_one_bottle_R.png", alt="The Lab", title="Lab", class="reportbutton")
						span(id="triggerSafariOrder")
						if(resultsOrders != null && resultsOrders !="")
							script(type="text/javascript" src="/javascripts/jspdf.js")
							script(type="text/javascript" src="/javascripts/FileSaver.js")
							script.
								var ob = "#{resultsOrders}"
								ob = ob.replace(/&lt;/g,"<");
								ob = ob.replace(/&gt;/g,">");

								var pdf = new jsPDF('l', 'pt', 'ledger');
								var pdf2 = new jsPDF('l', 'pt', 'ledger');
								// source can be HTML-formatted string, or a reference
								// to an actual DOM element from which the text will be scraped.
								source = ob;

								// we support special element handlers. Register them with jQuery-style 
								// ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
								// There is no support for any other type of selectors 
								// (class, of compound) at this time.
								specialElementHandlers = {
									// element with id of "bypass" - jQuery style selector
									'#bypassme': function(element, renderer) {
									// true = "handled elsewhere, bypass text extraction"
									return true;
								}
								};
								margins = {
									top: 30,
									bottom: 30,
									left: 40,
									right: 40,
									width: 622
								};

								// all coords and widths are in jsPDF instance's declared units
								// 'inches' in this case
								pdf.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								// dispose: object with X, Y of the last line add to the PDF 
								//          this allow the insertion of new lines after html
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									/*var binaryData = [];
									binaryData.push(pdf.output());
									var blob = new Blob(binaryData, {type: "application/pdf"});
									window.open(window.URL.createObjectURL(blob),'_blank');*/
									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf.output('dataurlnewwindow');
								}
								
								}
								, margins);		
								pdf2.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								// dispose: object with X, Y of the last line add to the PDF 
								//          this allow the insertion of new lines after html
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									/*var binaryData = [];
									binaryData.push(pdf.output());
									var blob = new Blob(binaryData, {type: "application/pdf"});
									window.open(window.URL.createObjectURL(blob),'_blank');*/
									pdf2.output('dataurlnewwindow');
								}
								else
								{
									pdf2.save("#{file_orders}");
								}
								
								}
								, margins);						
							- resultsOrders = ""
					script.
						$(window).scrollTop($('.reportOrders').offset().top).scrollLeft($('.reportOrders').offset().left);
			div(class="reportShares results", id="reportShares")
				div
				h4= i18n.__("reports.shares.title")
				p= i18n.__("reports.shares.subtitle")
				- var datefrom_shares = datefromShares
				- var dateto_shares = datetoShares
				- var file_shares = i18n.__("reports.shares.file") + datefrom_shares + i18n.__("reports.file.to") + dateto_shares + ".pdf"
				- var message_fail_share = i18n.__("reports.shares.message.fail")
				- var message_success_share = i18n.__("reports.shares.message.success1") + datefrom_shares + i18n.__("reports.shares.message.success2") + dateto_shares + i18n.__("reports.shares.message.success3")
				- if(datefromShares == null || datefromShares == undefined || datefromShares == "")
					- datefrom_shares = i18n.__("reports.shares.lab.option")
					- dateto_shares = ""
					- message_success_share = i18n.__("reports.shares.message.successshares")
					- file_shares = i18n.__("reports.shares.file_all") + ".pdf" 
				if (addMessageShares == 'failure')
					div(class="alert alert-danger")!= message_fail_share
				if (addMessageShares == 'success')
					div(class="alert alert-success fade in alert-dismissable")!= message_success_share
				div
					form(action="reportShares", method="post", id="formreportShares")
						div(class="buttonss")
							label(style="top: 23px; position: relative;font-weight: bold;")= i18n.__("reports.shares.datefrom")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateFrom" style="margin-left: 40px;margin-bottom:10px;margin-top: -13px;" type="text" id="reportDateFrom" class="form-control")
							
							label(style="top: 23px; position: relative;font-weight: bold;")= i18n.__("reports.shares.dateto")
							span(class="fa fa-calendar" style="top: 23px;position: relative;float: right;color: #3d9dcb;")
							input(name="reportDateTo" style="margin-left: 40px;margin-bottom:10px;margin-top: -13px;" type="text" id="reportDateTo" class="form-control")
							
							div(style="max-width:100%; margin-top: 20px;")
								button.btn.btn-success.btn-lg.btn-block(type="submit",value="Report",name="submit", style="max-width: 85%;width: 85%;")= i18n.__("reports.shares.button")
								img(src="images/logo_one_bottle_L.png", alt="The Lab", title="Lab", class="reportbutton")
						if(resultsShares != null && resultsShares !="")
							script(type="text/javascript" src="/javascripts/jspdf.js")
							script(type="text/javascript" src="/javascripts/FileSaver.js")
							script.
								var ob = "#{resultsShares}"
								ob = ob.replace(/&lt;/g,"<");
								ob = ob.replace(/&gt;/g,">");

								var pdf = new jsPDF('l', 'pt', 'ledger');
								var pdf2 = new jsPDF('l', 'pt', 'ledger');
								// source can be HTML-formatted string, or a reference
								// to an actual DOM element from which the text will be scraped.
								source = ob;

								// we support special element handlers. Register them with jQuery-style 
								// ID selector for either ID or node name. ("#iAmID", "div", "span" etc.)
								// There is no support for any other type of selectors 
								// (class, of compound) at this time.
								specialElementHandlers = {
									// element with id of "bypass" - jQuery style selector
									'#bypassme': function(element, renderer) {
									// true = "handled elsewhere, bypass text extraction"
									return true;
								}
								};
								margins = {
									top: 30,
									bottom: 30,
									left: 40,
									right: 40,
									width: 622
								};

								// all coords and widths are in jsPDF instance's declared units
								// 'inches' in this case
								pdf.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								// dispose: object with X, Y of the last line add to the PDF 
								//          this allow the insertion of new lines after html
								
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									/*var binaryData = [];
									binaryData.push(pdf.output());
									var blob = new Blob(binaryData, {type: "application/pdf"});
									window.open(window.URL.createObjectURL(blob),'_blank');*/
									//var blob = pdf.output();
									//window.open(window.URL.createObjectURL(blob),'_blank');

									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf.output('dataurlnewwindow');
									//pdf.save("#{file_shares}");
								}

								}
								, margins);	
								pdf2.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								// dispose: object with X, Y of the last line add to the PDF 
								//          this allow the insertion of new lines after html
								
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									/*var binaryData = [];
									binaryData.push(pdf.output());
									var blob = new Blob(binaryData, {type: "application/pdf"});
									window.open(window.URL.createObjectURL(blob),'_blank');*/
									//var blob = pdf.output();
									//window.open(window.URL.createObjectURL(blob),'_blank');

									//pdf2.output('dataurlnewwindow');
								}
								else
								{
									pdf2.save("#{file_shares}");
								}

								}
								, margins);
							- resultsShares = ""
					script.
						$(window).scrollTop($('.reportShares').offset().top).scrollLeft($('.reportShares').offset().left);
				script.
					$(document).ready(function(){
						//$.mask.definitions['~']='[+-]';
						//$("#eyescript").mask("~9.99 ~9.99 999");
						$("#reportDateFrom").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						$("#reportDateTo").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						$("#reportDateFromOrders").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						$("#reportDateToOrders").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						$("#reportDateFromMoney").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						$("#reportDateToMoney").mask("99-99-9999",{placeholder:"mm-dd-yyyy"});
						
					});
		div
			div(class="reportInsuff results", id="reportInsuff")
				div(style="/*background-color: #3d9dcb; height: 2px; margin-bottom: 30px; margin-top: 30px;*/")
				h4= i18n.__("reports.insuff.title")
				p=i18n.__("reports.insuff.subtitle")
				- var message_fail_insuff = i18n.__("reports.insuff.message.fail")
				- var message_success_insuff = i18n.__("reports.insuff.message.successinsuff")
				if (addMessageInsuff == 'failure')
					div(class="alert alert-danger")!= message_fail_insuff
				if (addMessageInsuff == 'success')
					div(class="alert alert-success fade in alert-dismissable")!= message_success_insuff
				div
					form(action="reportInsuff", method="post")
						div(class="buttonss")
							label(style="width: 100%;font-weight: bold;margin-top:10px;")!= i18n.__("reports.insuff.lab.label") + dept + "</span>"
							select(name="reportLabInsuff" type="text" id="reportLabInsuff" class="form-control" style="border-color:#3d9dcb;margin-bottom:10px" placeholder=i18n.__("reports.insuff.labselect"))
								option(value="all")= i18n.__("reports.insuff.lab.option")
								if(categories != undefined)
									- var ob = categories
									- for(var prop in ob)
										- var lab = ob[prop].labname
										option(value=lab) #{lab}
							div(style="top: -35px; position: relative; float: right; margin-right: 10px;")
								div(class="arrow-up")
								div(class="arrow-down")
							label(style="width: 100px;font-weight: bold;margin-top:10px;")= i18n.__("reports.insuff.show")
							br
							label(style="width: 60px;font-weight: bold;")= i18n.__("reports.insuff.vendor")
							input(type="checkbox" name="reportVendorInsuff" id="reportVendorInsuff" value="vendor" style="margin-top: -13px;")
							label(style="width: 75px; margin-left: 20px;font-weight: bold;")= i18n.__("reports.insuff.catalog")
							input(type="checkbox" name="reportCatalogInsuff" id="reportCatalogInsuff" value="catalogNumber" style="margin-top: -13px;")
							div(style="max-width:100%; margin-top: 20px;")
								button.btn.btn-success.btn-lg.btn-block(type="submit",value="Report",name="submit", style="max-width: 85%;width: 85%;")= i18n.__("reports.insuff.button")
								img(src="images/logo_one_bottle_R.png", alt="The Lab", title="Lab", class="reportbutton")
						if(resultsInsuff != null && resultsInsuff !="")
							- var file_insuff = i18n.__("reports.insuff.file") + labinsuff + ".pdf" 
							script(type="text/javascript" src="/javascripts/jspdf.js")
							script(type="text/javascript" src="/javascripts/FileSaver.js")
							script.
								var ob = "#{resultsInsuff}"
								ob = ob.replace(/&lt;/g,"<");
								ob = ob.replace(/&gt;/g,">");
								var pdf = new jsPDF('l', 'pt', 'ledger');
								var pdf2 = new jsPDF('l', 'pt', 'ledger');
								source = ob;
								specialElementHandlers = {
									'#bypassme': function(element, renderer) {
									return true;
								}
								};
								margins = {
									top: 30,
									bottom: 30,
									left: 40,
									right: 40,
									width: 622
								};
								pdf.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf.output('dataurlnewwindow');
								}

								}
								, margins);	
								pdf2.fromHTML(
									source, // HTML string or DOM elem ref.
									margins.left, // x coord
									margins.top, {// y coord
									'width': margins.width, // max width of content on PDF
									'elementHandlers': specialElementHandlers
								},
								function(dispose) {
								if (/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent))
								{
									pdf.output('dataurlnewwindow');
								}
								else
								{
									pdf2.save("#{file_insuff}");
								}
								}
								, margins);
							- resultsInsuff = ""
					script.
						$(window).scrollTop($('.reportInsuff').offset().top).scrollLeft($('.reportInsuff').offset().left);
		div(class="slide-out-tip-div desktabonly", style="display:none;z-index:1;position: fixed;top: 25% !important;max-height:400px;")
			a(class="handle" href="last-transactions", title='#{i18n.__("search.tip.title")}', style="right: -60px;,left:-60px;top:25px;")!=Content
			div(style="padding: 4px;color:white;")
				p(style="font-size: 12pt;")!= i18n.__("reports.tip.header")
				div(style="position: relative;float: right;width: 250px;font-size: 9pt;line-height: 1.3;border-radius: 4px;max-height:320px;overflow:auto;")
					span!= i18n.__("reports.tip.desc")
			script.
				$(function(){
				$('.slide-out-tip-div').tabSlideOut({
				imgPos: 60,
				tabHandle: '.handle',                              //class of the element that will be your tab
				pathToTabImage: 'images/bouee3.png',          //path to the image for the tab (optionaly can be set using css)
				imageHeight: '50px',                               //height of tab image
				imageWidth: '50px',                               //width of tab image    
				tabLocation: 'right',                               //side of screen where tab lives, top, right, bottom, or left
				speed: 300,                                        //speed of animation
				action: 'click',                                   //options: 'click' or 'hover', action to trigger animation
				topPos: '25% !important',                                   //position from the top
				fixedPosition: true                               //options: true makes it stick(fixed position) on scroll
				});
				});
		span(class="desktabonly", id="checkdisplay")
		script.
			$( document ).ready(function() {
				console.log( "reports document loaded" );
				if ($("#checkdisplay").css("display") == "none" ){
					$('.slide-out-tip-div').hide();
				} else {
					$('.slide-out-tip-div').show();
				}
			});

		span(class="checkintro")
		div(class='containerreport')
			input(id='funky' type='checkbox')
			label(for='funky')
				div(class='containerreport_button')
					span
						span!= i18n.__("reports.download.title")
					span(class="downloading")!= i18n.__("reports.download")
					i(class="fa fa-file-excel-o icon d_icon ion-cube", style="color:rgba(138, 109, 59, 0.68) !important;font-size:35pt")
					i(class="fa fa-check icon complete ion-checkmark-round", style="color:#8a6d3b !important;font-size: 47pt;")
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='point')
					div(class='containerreport_button__bar')
		if(resultsMoneyIntro != null && resultsMoneyIntro !="")
			div(class="intro",style="margin-top:500px;display:none;")!= resultsMoneyIntro
			script(type="text/javascript" src="/javascripts/jspdf.js")
			script(type="text/javascript" src="/javascripts/FileSaver.js")
			script.
				$(".containerreport_button").click(function() {
				
				if ( !$( ".checkintro" ).hasClass( "noshow" ) ) {
				//if($('.fa-check:visible').size() > 0){
				console.log("clicked");
				$('.intro').show();
				var ob = "#{resultsMoneyIntro}"
				ob = ob.replace(/&lt;/g,"<");
				ob = ob.replace(/&gt;/g,">");
				var pdf = new jsPDF('l', 'pt', 'ledger');
				var pdf2 = new jsPDF('p', 'pt', 'letter');
				pdf2.setFont("courier", "normal");
				pdf2.setFontSize(10);
				source = ob;
				
				console.debug(source);
				var options = {
					background: '#fff'
				};
				pdf2.addHTML($(".intro"),options,function() {
					console.log("source");
					var filetext = "#{i18n.__("reports.download.today.file")}";
					//var string = pdf2.output('datauristring');
					pdf2.save(filetext);
					$('.intro').hide();
					$('.checkintro').addClass("noshow");
				});

				} else {
					$('.checkintro').removeClass("noshow");
				}
				});
			
doctype html
html(lang='en')
   head
     - var a = "layout." + title
     - var language = "en"
     - if(lang != null && lang != undefined)
        - language = lang
     - var isreghide = "isreghide"
     - var isregpadding = "isregpadding"
     - var menushare = "menushare"
     - var menumyshares = "menumyshares2"
     - var isadminroundaccountLeft = " isadminroundaccountLeft "
     - var isregroundaccountLeft = " isregroundaccountLeft "
     - var roundaccountLeft = isregroundaccountLeft
     - if(isLoggedInAdmin == true)
        - roundaccountLeft = isadminroundaccountLeft
        - isreghide = ""
        - isregpadding = ""
        - menushare = ""
        - menumyshares = ""
     title!= 'LabYoke - ' + i18n.__(a)
     :staticCache
        link(href='/css/animate.css', rel='stylesheet')
     if (title=='Orders' || title == "Share" || title=="Search" || title=="Help" || title=="Admins" || title=='Reagent Search')
      :staticCache
        link(rel="stylesheet" type="text/css" href="/css/datatables.min.css")
     if(title=='Reagent Search' || title=='Search' || title=='Share' || title=='Orders' || title=='Admins')
      :staticCache
        link(href='/css/popup.css', rel='stylesheet')
     :staticCache
      link(href='/css/botchat.css', rel='stylesheet')
      link(href='/css/bootstrap.css', rel='stylesheet')
      link(href='/css/bl.css', rel='stylesheet')
      link(href='/css/font-awesome.css', rel='stylesheet')
      link(href='/css/animation.css', rel='stylesheet')
      link(href='/css/hamburgers-master/dist/hamburgers.css', rel='stylesheet')
     if (title=='About Us')
       :staticCache
        link(href='/css/rotating-card.css', rel='stylesheet')
     if (title=='Share' || title=='Admins')
       :staticCache
        link(href='/css/normalize.css', rel='stylesheet')
        link(href='/css/component.css', rel='stylesheet')
        link(href='/css/chartist.min.css', rel='stylesheet')
     if (title=='Orders')
      :staticCache
        link(href='/css/chartist.min.css', rel='stylesheet')
     meta(http-equiv='Content-Type', content='text/html; charset=UTF-8')
     meta(http-equiv='X-UA-Compatible', content='IE=edge')
     meta(name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, minimum-scale=1.0, user-scalable=no")
     meta(name='robots', content='noindex, nofollow')
     :staticCache 
      script(type="text/javascript" src="//ajax.googleapis.com/ajax/libs/jquery/1.11.1/jquery.min.js")
      script(type="text/javascript" src="/javascripts/js.cookie.js")
      script(type="text/javascript" src="/javascripts/jquery.page_zoom.min.js")

     if (title=='Orders' || title == "Share" || title=="Search" || title=="Help" || title=="Admins" || title=='Reagent Search')
      :staticCache
        script(type="text/javascript" src="https://cdn.datatables.net/v/dt/dt-1.10.12/datatables.min.js")
     if (title=='Share')
       :staticCache
        script(type="text/javascript" src="/javascripts/canvas2svg.js")
        script(type="text/javascript" src="/javascripts/jvenn.min.js")
        script(type="text/javascript" src="/javascripts/jquery.twbsPagination.min.js")
     if (title!='Help' || title!='About')
       :staticCache
        script(type="text/javascript" src="/javascripts/jquery.slideout.js")
     if (title == "Share" || title=="Admins")
        :staticCache
         script(type="text/javascript" src="/javascripts/jumpToData.js")
     :staticCache
      link(rel="shortcut icon" href="/images/favicon.ico" type="image/x-icon")
      link(rel="icon" href="/images/favicon.ico" type="image/x-icon")

     if scripts
       each script in scripts
          script(type='text/javascript', src=script)
   - var user = labyoker
   - var surname = labyokersurname
   - var user_surname = user
   - if(user_surname != null && user_surname != undefined && user_surname.length>1)
      - user_surname = user_surname.substring(0, 1)
   - else
      - user_surname = "."
   - if(surname != null && surname != undefined && surname.length>1)
      - surname = surname.substring(0, 1)
   - else
      - surname = "..."

   - var sharesnumber = sharesnum
   - var ordersnumber = ordersnum
   - var ordersnumclass = "num"
   - var sharesnumclass = "num"
   - if(sharesnumber == null || sharesnumber == undefined)
       - sharesnumber = 0
   - if(ordersnumber == null || ordersnumber == undefined)
       - ordersnumber = 0
   - if(sharesnumber != null && sharesnumber <10)
        - sharesnumclass = "num"
   - else if(sharesnumber != null && sharesnumber <100)
        - sharesnumclass = "num greatherthannine"
   - else if(sharesnumber != null && sharesnumber <1000)
        - sharesnumclass = "num greatherthanninetynine"

   - if(ordersnumber != null && ordersnumber <10)
        - ordersnumclass = "num"
   - else if(ordersnumber != null && ordersnumber <100)
        - ordersnumclass = "num greatherthannine"
   - else if(ordersnumber != null && ordersnumber <1000)
        - ordersnumclass = "num greatherthanninetynine"
   - if(user != null && user != undefined && user.length>11)
        - user = user.substring(0, 8)
        - if(user.substring(8,8) == " ")
           - user = user.substring(0,7)
   if(title=='Login')
      :staticCache
        script(type="text/javascript" src="/javascripts/imageCache.js")
   body(class=loggedIn, ontouchstart="")
     span(class="topping")

     if (loggedIn==true)
        script.
          sessionStorage.clear();
          console.log("cleared sessionStorage");
        .navbar.navbar-inverse.navbar-fixed-top.adjustnav.navbackground(role='navigation',style="background-color: white;font-size: 10pt;position:fixed !important;padding-top:10px")
            .container.nobottom(style="margin-top: 5px;")
                .navbar-header.paddingrightnav(style="margin-bottom: 16px;float:right; margin-left:auto;margin-right: -10px;")
                    button(class="hamburger hamburger--spring" data-toggle="collapse" data-target=".navbar-collapse" type="button" style="outline:none")
                      span(class="hamburger-box")
                        span(class="hamburger-inner")

                    - activateReports = "addMargin "
                    - activateShares = "addMargin "
                    - activateSearch = "addMargin desktabonly5 "
                    - activateHelp = "addMargin "
                    - activateAbout = "addMargin "
                    - activateOrders = "addMargin "
                    - activateAccount = "account-borders addMargin movetoleft " + isreghide
                    - activateAdmin = "addMargin "
                    - activeSearchMob = ""
                    - activeAccountMob = ""
                    - if (title == 'Reports')
                        - activateReports = activateShares + "labColorBackgroundHover"
                    - if (title == 'Share')
                        - activateShares = activateShares + "labColorBackgroundHover"
                    - if (title == 'Reagent Search')
                        - activateSearch = activateSearch + "labColorBackgroundHover"
                        - activeSearchMob = "labColorBackgroundHover colorsearchback pressedbutton"
                    - if (title == 'Search')
                        - activateSearch = activateSearch + "labColorBackgroundHover"
                        - activeSearchMob = "labColorBackgroundHover pressedbutton"
                    - if (title == 'Help')
                        - activateHelp = activateHelp + "labColorBackgroundHover"
                    - if (title == 'Orders')
                        - activateOrders = activateOrders + "labColorBackgroundHover"
                    - if (title == 'Account')
                        - activateAccount = activateAccount
                        - activeAccountMob = "labColorBackgroundHover pressedbutton"
                    - if (title == 'About Us')
                        - activateAbout = activateAbout + "labColorBackgroundHover"
                    - if (title == 'Admins')
                        - activateAdmin = activateAdmin + "labColorBackgroundHover"
                span
                  a(href="/account", class="roundaccountmob " + activeAccountMob, style="font-size: 17px;color: white;text-decoration: none;")!= user_surname + "" + surname
                span
                  a(href="/search", class="roundaccountmob searchmob " + activeSearchMob, style="color: white;text-decoration: none;")
                    span(class="fa fa-search colmenu " + activeSearchMob, style="color: white;font-size: 11pt;")
                .collapse.navbar-collapse(id="navburger")
                    div.adjustWidthSearch(style="float:left", class=isreghide)
                        - adjustWidth = ""
                        - menuaccount = "menumyaccountadmin"
                        if(isLoggedInAdmin == false)
                            - adjustWidth =  "width: 111px;"
                            - menuaccount = "menumyaccount"
                        ul.nav.navbar-nav.addMargin.adjustWidthSearchUL(id="#menumyaccounta")
                            li(class=activateSearch)
                                a(href="/search", class="nav-menu",id="menusearch", style=adjustWidth)
                                    span(class="fa fa-search colmenu", style="font-size: 14pt;margin-top: -5px")
                                    span 
                            if(isLoggedInAdmin == true)
                                li(class=activateReports)
                                        a(href="/reports",class="nav-menu", id="menusearch", style="")
                                            span(class="fa fa-file-text colmenu")
                                            span #{i18n.__("layout.Reports")}
                                li(class=activateAdmin)
                                        a(href="/admins",class="nav-menu", id="menusearch", style="")
                                            span(class="fa fa-user-plus colmenu")
                                            span #{i18n.__("layout.Admin")}
                            
                    div(class="paddingMobile " + isregpadding)
                        ul.nav.navbar-nav(id="menumyshares", class="addMargin menumyshares " + menumyshares, style="border-left-color: white;border-left-style: solid;border-width: thick;")
                            li(class=activateShares)
                                a(href="/share",class="nav-menu",id=menusharess)
                                    span(class="fa fa-exchange colmenu")
                                    span #{i18n.__("layout.Share")}
                                   - if(sharesnumber>0) 
                                    span(class="fa fa-comment bubble1")
                                    span(class=sharesnumclass, id="bubblenum1")!=sharesnumber
                            li(class=activateOrders)
                                a(href="/orders",class="nav-menu",id=menusharess)
                                    span(class="fa fa-ship colmenu")
                                    span #{i18n.__("layout.Orders")}
                                  - if(ordersnumber>0) 
                                    span(class="fa fa-comment")
                                    span(class=ordersnumclass)!=ordersnumber
                        ul.nav.navbar-nav(id=menuaccount, class="addMargin menu-border padnum")
                            li(class="account-borders addMargin")
                                span
                                  a(href="/account", class="roundaccount " + roundaccountLeft + activeAccountMob)!=user_surname + "" + surname
                            li(class=activateHelp)
                                a(href='/help', class="nav-menu",id="menumyaccounta")
                                    span(class="fa fa-anchor colmenu")
                                    span #{i18n.__("layout.Help")}
                            li(class=activateAbout)
                                a(href='/about', class="nav-menu",id="menumyaccounta")
                                    span(class="fa fa-home colmenu")
                                    span #{i18n.__("layout.Us")}
                    ul.nav.navbar-nav.navbar-right
                        li(class="nav-menu-logout", style="cursor:pointer")
                            a 
                                span(class="desktabonly4",style="margin-left: 5px;") #{i18n.__("layout.Logout")}
                                span(class="mobileonly2",style="margin-left: 5px;") #{i18n.__("layout.Logout2")}

     block content
     :staticCache
      script(type="text/javascript" src="/javascripts/bootstrap.min.js")
     if(title=='Reagent Search' || title=='Search' || title=='Share' || title=='Orders' || title=='Admins' || title=='Account')     
      script(type="text/javascript" src="/javascripts/init.js")
      script.
        var l = "#{language}";
        console.log("l is: " + l);
        MYLIBRARY.init([l]);
      script(type="text/javascript" src="/javascripts/popup.js")
      :staticCache
        script(type="text/javascript" src="https://ajax.googleapis.com/ajax/libs/jqueryui/1.12.1/jquery-ui.min.js")
     if(title=='Reagent Search' || title=='Search' || title=='Share' || title=='Orders' || title=='Account')
      :staticCache
        script(src="https://cdn.botframework.com/botframework-webchat/latest/botchat.js")
      script.

          $(document).ready(function() {
          $(".sleepimg").click(function() {
                $( "#bot" ).show();
                $( ".awake" ).show();
                $( ".sleep" ).hide();
                $( "#popup1bot" ).show();
                $(".overlaybot").css({ 'visibility' : 'visible', 'opacity' : '1' });
                setTimeout(function() { $('.wc-shellinput').focus(); $(".wc-shellinput").attr("placeholder",'#{i18n.__("layout.bot.placeholder")}'); }, 1000);
              });
          
          $(".close").click(function() {
                $( "#bot" ).hide();
                $( ".awake" ).hide();
                $( ".sleep" ).show();
                $( "#popup1bot" ).hide();
              });
          });

      div(class="labbot sleep" style="")
        span(class="fa fa-comment sleep0" style="display: block;font-size: 15pt;margin-left: 20px;color: #3e9ccb;font-weight: bold;position: initial;")
        img(src="/images/tip5.png" class="sleepimg" style="width: 40px;")      
      div(id="popup1bot" class="overlaybot")
        div(class="popupbot")
          div
            div(class="modal-header")
              span(class="fa fa-arrows" style="font-size: 28pt;color: #8e784d;")
            a(class="close" href="#") &times;
          div(class="contentbot")
            div(class="labbot awake" style="")
              span(class="fa fa-commenting" style="display: block;font-size: 15pt;margin-left: 20px;color: #3e9ccb;font-weight: bold;")
              img(src="/images/tip3.png" style="width: 50px;")
            div(id="bot", style="position: relative;bottom: 0px;margin: 10px;margin-top: -240px;")
      
     if (title=='Share' || title=='Admins')
       :staticCache
        script(type="text/javascript" src="/javascripts/custom-file-input.js")
     if(title=='Reports')
       :staticCache
        script(type="text/javascript" src="/javascripts/html2canvas.js")
     if (title=='Reports' || title=='Account' || title=='Register' || title=='Confirm Registration' || title=='Change Password')
       :staticCache
        script(type="text/javascript" src="/javascripts/jquery.maskedinput.min.js")
     if (title=='Reports')
       :staticCache
        script(type="text/javascript" src="/javascripts/jspdf.js")
        script(type="text/javascript" src="/javascripts/xlsx.core.min.js")
        script(type="text/javascript" src="/javascripts/Blob.js")
        script(type="text/javascript" src="/javascripts/FileSaver.js")
        script(type="text/javascript" src="/javascripts/savexl.js")
     if (title=='Reports' || title=='Account' || title=='Register' || title=='Confirm Registration' || title=='About Us' || title=='Change Password' || title=='Forgot Password' || title=='Register' || title=='Help' || title=='Orders' || (title=='Share' && !doing) || title=='Search' || title == 'Reagent Search' || title == 'Admins')
       :staticCache
        script(type="text/javascript" src="/javascripts/spinner.js")

       script.
          var h = $(window).height() - 125;
          $(".marginbottom").css("min-height",h);
     div(style="margin-top: 40px; background-color: #8a6d3b; position: fixed;bottom: 0;width: 100%;")
            div(style="color:white; text-align:center; font-size:11px;")="@LabYoke"
              img(src="/images/"+language+".png" alt="Language" data-toggle="tooltip" title="Language" style="width: 15px;margin-left: 9px;")
     a(href="#0" class="cd-top" title="go to top")
      span(class="fa fa-chevron-circle-up")
    script.
        $(function(){
            $('#popup1bot').draggable({
              handle: ".modal-header"
          });
            $('#popup1bot').resizable();

          $('.sleep').draggable({
              handle: ".sleep0"
          });
            $('.sleep').resizable();
          
        });
        $(document).ready(function() {

            // browser window scroll (in pixels) after which the "back to top" link is shown
            var offset = 300,
              //browser window scroll (in pixels) after which the "back to top" link opacity is reduced
              offset_opacity = 1200,
              //duration of the top scrolling animation (in ms)
              scroll_top_duration = 700,
              //grab the "back to top" link
              $back_to_top = $('.cd-top');

            //hide or show the "back to top" link
            $(window).scroll(function(){
              ( $(this).scrollTop() > offset ) ? $back_to_top.addClass('cd-is-visible') : $back_to_top.removeClass('cd-is-visible cd-fade-out');
              if( $(this).scrollTop() > offset_opacity ) { 
                $back_to_top.addClass('cd-fade-out');
              }
            });
            //smooth scroll to top
          $back_to_top.on('click', function(event){
            event.preventDefault();
            $('body,html').animate({
              scrollTop: 0 ,
              }, scroll_top_duration
            );
          });

        function hasTouch() {
            return 'ontouchstart' in document.documentElement
                   || navigator.maxTouchPoints > 0
                   || navigator.msMaxTouchPoints > 0;
        }
        if(!hasTouch()){
          var query = $('#bot');
          var isVisible = query.is(':visible');
          if (isVisible === true) {
          //var botchat = document.querySelector("#bot");
          //if(botchat != undefined && botchat != null){

          BotChat.App({
            directLine: { secret: "jMO0wtNhTWM.cwA.rqg._IWRYZZ7OsyoD0F6JfuPEDOnw6SP48-pAnIRptYH3mE" },
            user: { id: '#{labyoker}' },
            bot: { id: 'Labyoke' },
            resize: 'detect'
          }, document.getElementById("bot"));
          $( "#bot" ).hide();
          }
        } 


        //$('[data-toggle="tooltip"]').tooltip({placement: "bottom"});
        var options = {
          max_zoom: 1.3, // maximum amount you can zoom in. 1.5 = 150% zoom
          min_zoom: .7, // the minimum amount you can zoom out. .5 = 50% zoom
          zoom_increment: .1, // how much each click zooms in/out. So if the current zoom is 1.3, one click of the zoom out link means 1.3 - 0.1 = 1.2. New zoom level is 1.2
          current_zoom: 1, // default zoom. don't set this unless you want to force a zoom level on each page load
          selectors: {
            zoom_in: '.zoom_in', // the selector for the element(s) that will get the zoom in action for the onclick event
            zoom_out: '.zoom_out', // the selector for the element(s) that will get the zoom out action for the onclick event
            zoom_reset: '.zoom_reset' // the selector for the element(s) that will get the reset zoom action for the onclick event
          }
        };

        $.page_zoom(options);});
        $(".nav-menu-logout").click(function() {
                    $( this ).addClass( "animated hinge" );
                    setTimeout(function() {
                      window.location.href = "/logout";
                    }, 2000);
                    });
        // Look for .hamburger
        var hamburger = document.querySelector(".hamburger");
        // On click
        if(hamburger != undefined && hamburger != null){
        hamburger.addEventListener("click", function() {
          // Toggle class "is-active"
          hamburger.classList.toggle("is-active");
          // Do something else, like open/close menu
          console.log("clicked hamburger.");
        });
        }
        
        var logout = document.querySelector(".nav-menu-logout");
        // On click
        if(logout != undefined && logout != null){
        logout.addEventListener("click", function() {
              $(".menu-border").css("border-left-color", "transparent");
              $("#menumyshares").css("border-left-color", "transparent");
            });
        }

          

